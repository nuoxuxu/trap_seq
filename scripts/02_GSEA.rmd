---
title: "Gene set enrichment analysis for TRAP-seq data"
output:
  html_notebook:
    toc: true
    number_sections: true
    theme: readable
author: Nuo Xu
date: "`r format(Sys.time(), 'Generated on %d %B, %Y')`"
---
    
```{r load_libraries, message=FALSE, warning=FALSE}
library(clusterProfiler)
library(org.Hs.eg.db)
library(ggrepel)
```

```{r}
res_for_GSEA <- read.csv("results/results.csv", header = TRUE, row.names = 1)
```
```{r}
geneList <- res_for_GSEA$log2_RE_FC
names(geneList) <- res_for_GSEA$gene_id
geneList <- sort(geneList, decreasing = TRUE)
```

```{r}
ego3 <- gseGO(geneList     = geneList,
              OrgDb        = org.Hs.eg.db,
              ont          = "ALL",
              keyType      = "ENSEMBL",
              minGSSize    = 100,
              maxGSSize    = 500,
              pvalueCutoff = 0.05,
              verbose      = FALSE)
```

```{r}
length(geneList)
```